var graph,graphic,eightEdges=true,mapa,origem,destino;var pathfinding={getOption:function(a){var c=document.getElementById("choice")[a];for(var b=0;b<c.length;b++){if(c[b].checked){break}}return c[b].value},setMap:function(){var a=this.getOption("mapa");switch(a){case"maze1":mapa=dirtmapa;origem={x:29,y:19};destino={x:1,y:30};break;case"maze2":mapa=dirtmapa2;origem={x:40,y:1};destino={x:1,y:27};break;case"blockmap1":mapa=cmapa;origem={x:3,y:15};destino={x:21,y:15};break;case"blockmap2":mapa=cmapa;destino={x:3,y:28};origem={x:21,y:15};break;case"open":default:mapa=cleanmapa;origem={x:20,y:16};destino={x:4,y:4}}},generateStatistic:function(){var c={};c.tiles=0;c.tilesClosed=0;c.tilesVisited=0;c.tilesOpen=0;var d;var a,b;for(a=1;a<graph.grid.length-1;a++){for(b=1;b<graph.grid[a].length-1;b++){d=graph.grid[a][b];if(d.blocked===false){c.tiles++;if(d.visited===true){c.tilesVisited++;if(d.closed===false){c.tilesOpen++}else{c.tilesClosed++}}}}}return c},clear:function(){this.setMap();graph=new Graph(mapa);graphic.render(graph,origem,destino);var a=document.getElementById("estatistica");a.style.display="none";a.textContent=""},run:function(){this.setMap();graph=new Graph(mapa);var k;var j=function(l){switch(l){case"sim":return true;case"nao":default:return false}}(this.getOption("admissible"));switch(this.getOption("algorithm")){case"astar_dd":if(j){k=new aStarDiagonalDistanceSearchPath(graph);break}k=new aStarDiagonalDistanceISearchPath(graph);break;case"astar_md":if(j){k=new aStarManhattanDistanceSearchPath(graph);break}k=new aStarManhattanDistanceISearchPath(graph);break;case"astar_ed":if(j){k=new aStarEuclideanDistanceSearchPath(graph);break}k=new aStarEuclideanDistanceISearchPath(graph);break;case"bfs":k=new BreadthFirstSearchPath(graph);break;case"ucs":if(j){k=new UniformCostSearchPath(graph);break}k=new UniformCostSearchIPath(graph);break;case"bestfs":if(j){k=new bestFirstSearchPath(graph);break}k=new bestFirstISearchPath(graph);break;default:k=new aStarSearchPath(graph)}switch(this.getOption("grid_connected")){case"4":eightEdges=false;break;case"8":default:eightEdges=true}var c=(new Date()).getTime();k.searchPath(origem,destino);var h=(new Date()).getTime();graph.grid[origem.y][origem.x].text="";graphic.render(graph,origem,destino);var a=this.generateStatistic();var f=((a.tilesVisited/a.tiles)*100).toFixed(2);var e=(((a.tiles-a.tilesVisited)/a.tiles)*100).toFixed(2);var b=((a.tilesOpen/a.tiles)*100).toFixed(2);var d=((a.tilesClosed/a.tiles)*100).toFixed(2);var g=(graph.grid[destino.y][destino.x].custo);g=function(l){if(l<=0){return"???"}return l.toFixed(3)}(g);var i=document.getElementById("estatistica");i.textContent="Estatística:\n";i.textContent+="Total de Nós: \t"+a.tiles+"\n";i.textContent+="Nós Visitados: \t"+a.tilesVisited;i.textContent+=" \t("+f+"%)\n";i.textContent+="Não visitados: \t"+(a.tiles-a.tilesVisited);i.textContent+=" \t("+e+"%)\n";i.textContent+="Nós Abertos: \t"+a.tilesOpen;i.textContent+=" \t("+b+"%)\n";i.textContent+="Nós Fechados: \t"+a.tilesClosed;i.textContent+=" \t("+d+"%)\n";i.textContent+="Tempo Total: \t"+(h-c)+"ms\n";i.textContent+="Custo Total: \t"+g;i.style.display="block"},init:function(){var a=document.getElementById("run");a.onclick=function(){pathfinding.run()};a=document.getElementById("clear");a.onclick=function(){pathfinding.clear()};pathfinding.setMap();try{graphic=new Graphic(document.getElementById("grid"),mapa[0].length,mapa.length);pathfinding.clear();delete pathfinding.init}catch(b){window.setTimeout(pathfinding.init,500)}}};window.onload=pathfinding.init;